<main class="container-carrusel w-full">
  <!-- Contendor de todo el carrusel -->
  <section class="carrusel flex flex-row animation-slide">
    <!-- Carrusel -->
    <!-- Cada DIV es un grupo del carrusel -->

    <!-- Grupo 1 -->
    <div class="grupo flex-row flex border-2 border-white/20" id="1">
      <div class="player"><h2>Mateo</h2><span>Ríos</span></div>
      <div class="player"><h2>Valentina</h2><span>Torres</span></div>
      <div class="player"><h2>Lucas</h2><span>Fernández</span></div>
      <div class="player"><h2>Sofía</h2><span>Morales</span></div>
      <div class="player"><h2>Tomás</h2><span>Herrera</span></div>
      <div class="player"><h2>Camila</h2><span>Navarro</span></div>
      <div class="player"><h2>Ignacio</h2><span>Vega</span></div>
      <div class="player"><h2>Isabella</h2><span>Muñoz</span></div>
      <div class="player">
        <h2 class="text-red-800">Martín</h2><span>Castro</span>
      </div>
    </div>

    <!-- Grupo 2 -->
    <div class="grupo flex-row flex" id="2">
      <div class="player"><h2>Mateo</h2><span>Ríos</span></div>
      <div class="player"><h2>Valentina</h2><span>Torres</span></div>
      <div class="player"><h2>Lucas</h2><span>Fernández</span></div>
      <div class="player"><h2>Sofía</h2><span>Morales</span></div>
      <div class="player"><h2>Tomás</h2><span>Herrera</span></div>
      <div class="player"><h2>Camila</h2><span>Navarro</span></div>
      <div class="player"><h2>Ignacio</h2><span>Vega</span></div>
      <div class="player"><h2>Isabella</h2><span>Muñoz</span></div>
      <div class="player">
        <h2 class="text-red-800">Martín</h2><span>Castro</span>
      </div>
    </div>
  </section>
</main>

<style>
  .container-carrusel {
    overflow: hidden;
    white-space: nowrap;
    border: solid 2px rgba(255, 255, 255, 0.445);
    max-width: 90%;
    place-self: center;
    border-radius: 2px;
  }

  section .carrusel {
    display: flex;
    gap: 5px;
    justify-content: center;
    align-items: center;
    animation: scroll 100s cubic-bezier(0, -0.17, 0, 1.01) forwards;
    background-color: blue;
  }

  .grupo {
    display: flex;
  }

  /* div h2 {
    font-size: 25px;
  }

  div span {
    font-weight: bolder;
    font-size: 12px;
    color: rgb(173, 173, 173);
  } */
  .player {
    aspect-ratio: 1 / 1; /* o 4 / 3, 1 / 1, etc */
    width: 100%;
    object-fit: contain; /* o contain, según tu necesidad */
    height: 100px;
    margin: 20px 5px;
    background: linear-gradient(
      0deg,
      rgba(16, 8, 248, 0.6) 0%,
      transparent 20%
    );
  }

  @keyframes scroll {
    0% {
      transform: translateX(0%);
    }
    100% {
      transform: translateX(-5000%); /* frena */
    }
  }

  /* Aplicar el suavizado solo al final de la animación */
  .animation-slide {
    animation: scroll 10.5s forwards;
    animation-timing-function: cubic-bezier(0, -0.17, 0, 1.01);
  }
</style>

<script>
  const grupoNuevo = `
    <div class="grupo flex-row flex border-2 border-white/20" id="2">
      <div class="player"><h2>Mateo</h2><span>Ríos</span></div>
      <div class="player"><h2>Valentina</h2><span>Torres</span></div>
      <div class="player"><h2>Lucas</h2><span>Fernández</span></div>
      <div class="player"><h2>Sofía</h2><span>Morales</span></div>
      <div class="player"><h2>Tomás</h2><span>Herrera</span></div>
      <div class="player"><h2>Camila</h2><span>Navarro</span></div>
      <div class="player"><h2>Ignacio</h2><span>Vega</span></div>
      <div class="player"><h2>Isabella</h2><span>Muñoz</span></div>
      <div class="player">
        <h2 class="text-red-800">Martín</h2><span>Castro</span>
      </div>
    </div>
  `;

  // Función para forzar el recálculo de los estilos del nuevo nodo
  function cargarCSS(ruta :string) {
    const head = document.head;
    const link = document.createElement("link");

    link.rel = "stylesheet";
    link.href = ruta;

    head.appendChild(link);
  }
  function ver_coordenadas() {
    const padre = document.querySelector(".container-carrusel");
    const grupo1 = document.getElementById("1")!;
    const carrusel = document.querySelector(".carrusel");

    if (!padre || !carrusel) return;

    const padre_coords = padre.getBoundingClientRect();
    const grupo1_coords = grupo1.getBoundingClientRect();


    if (padre_coords.left > grupo1_coords.right) {
      grupo1.id = "0"
      console.log("Ya pasó el primer grupo");


      // Cambiar el id del grupo 2 a 1
      const grupo2 = document.getElementById("2");
      if (grupo2) {
        grupo2.id = "1"; // El grupo 2 ahora tiene el id 1
      }

      // Convertir string HTML en nodo real para el nuevo grupo
      const temp = document.createElement("div");
      temp.innerHTML = grupoNuevo;
      const nuevoNodo = temp.firstElementChild!;

      // Asignar el id 2 al nuevo grupo
      nuevoNodo.id = "2"; // El nuevo grupo tiene el id 2

      // Agregar el nuevo grupo al carrusel
      if (nuevoNodo) {
        carrusel.appendChild(nuevoNodo);
        cargarCSS("/css/estilarPlayers.css");
      }
    }

    requestAnimationFrame(ver_coordenadas);
  }

  requestAnimationFrame(ver_coordenadas);
</script>
